<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PDF to Word Converter — Storedropship</title>
  <meta name="description" content="Convert PDF to editable Word (.docx) directly in your browser. Upload a PDF, extract text, and download a DOCX file. Works offline, no server required." />
  <meta name="keywords" content="PDF to Word, PDF converter, DOCX, convert PDF to DOCX, offline PDF to Word" />
  <style>
    :root{--bg:#f7fafc;--card:#fff;--muted:#6b7280;--accent:#0ea5a4}
    *{box-sizing:border-box;font-family:Inter,Segoe UI,Roboto,Arial,sans-serif}
    body{margin:0;background:linear-gradient(180deg,var(--bg),#eef2ff);padding:20px;color:#0f172a}
    .wrap{max-width:980px;margin:0 auto}
    .card{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 8px 30px rgba(10,20,40,0.06);margin-bottom:14px}
    h1{margin:0 0 6px;font-size:20px}
    p.lead{margin:0 0 12px;color:var(--muted)}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    label{font-size:13px;color:#374151}
    input,button{width:100%;padding:10px;border-radius:8px;border:1px solid #e6eef6;font-size:14px}
    .controls{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
    button.primary{background:var(--accent);color:#fff;border:none;padding:10px;border-radius:8px;cursor:pointer}
    button.alt{background:#fff;border:1px solid #e6eef6;color:#0b5394;padding:10px;border-radius:8px}
    pre{background:#f8fafc;padding:12px;border-radius:8px;border:1px solid #e6e9ef;overflow:auto;max-height:420px;white-space:pre-wrap;word-break:break-word}
    .meta{font-size:13px;color:var(--muted);margin-top:8px}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}
  </style>
  <!-- PDF.js (text extraction only) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.9.179/pdf.min.js" integrity="sha512-g8nYt3t8s7wQ8S8nQw+7JdE8nq1g5e9Jq1zv7G8pQ5t8z5z0l5Vg3J9b2u2y1P0l2gDVh6lJvQYQG6m6C8t0VQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <!-- docx.js for generating .docx in browser -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/8.3.0/docx.umd.min.js" integrity="sha512-+iMx8Y8Qw8XQv1oZVq6JXj2y9t0s0yQWb8XJ5v2AqW0gI3b7xvYxBv6J5L0T2q3p0S7l2fR3O3O7Qm6u8MZk7w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>PDF to Word (DOCX)</h1>
      <p class="lead">Convert your PDF to an editable Word document, right in the browser. Text-only conversion with page breaks — no upload to a server.</p>

      <div class="grid">
        <div>
          <label for="pdfFile">Choose PDF</label>
          <input id="pdfFile" type="file" accept="application/pdf" />
          <div class="controls">
            <button id="convertBtn" class="primary">Convert to DOCX</button>
            <button id="previewBtn" class="alt">Preview Extracted Text</button>
            <button id="clearBtn" class="alt">Clear</button>
          </div>
          <div class="meta">Note: This tool extracts selectable text from digital PDFs. Scanned PDFs (images) require OCR, which is not included. For best results, ensure the PDF text is selectable.</div>
        </div>
        <div>
          <label>Preview of extracted text</label>
          <pre id="preview">No file loaded yet.</pre>
        </div>
      </div>
    </div>

    <div class="card">
      <h2 style="margin:0 0 8px">Description</h2>
      <p style="margin:0;color:#374151;line-height:1.6">This PDF to Word converter runs entirely in your browser using PDF.js for text extraction and docx.js for building the .docx file. It is ideal for quick, privacy-friendly conversions where you only need the text content. Features:</p>
      <ul style="margin-top:8px;color:#374151">
        <li>Client-side conversion: no server uploads.</li>
        <li>Preserves page breaks and basic paragraph spacing.</li>
        <li>Download a clean DOCX you can open in Microsoft Word, Google Docs, or LibreOffice.</li>
        <li>Works offline after first load (if cached by your browser).</li>
      </ul>
      <p class="meta">Limitations: complex layouts, tables, forms, and images are not reconstructed; only text is exported. Use a dedicated desktop converter if you need pixel-perfect fidelity or OCR.</p>
    </div>
  </div>

  <script>
    const fileEl = document.getElementById('pdfFile');
    const convertBtn = document.getElementById('convertBtn');
    const previewBtn = document.getElementById('previewBtn');
    const clearBtn = document.getElementById('clearBtn');
    const preview = document.getElementById('preview');

    let currentPdfBytes = null;

    fileEl.addEventListener('change', async (e) => {
      const file = e.target.files[0];
      if (!file) return;
      currentPdfBytes = await file.arrayBuffer();
      preview.textContent = 'File loaded. Click "Preview Extracted Text" or "Convert to DOCX".';
    });

    async function extractPdfText(arrayBuffer){
      const pdfjsLib = window['pdfjs-dist/build/pdf'];
      if (!pdfjsLib) throw new Error('PDF.js not loaded');
      // worker is optional for small docs; leaving unset uses workerless mode in this build
      const loadingTask = pdfjsLib.getDocument({ data: arrayBuffer });
      const pdf = await loadingTask.promise;
      let all = [];
      for (let p = 1; p <= pdf.numPages; p++){
        const page = await pdf.getPage(p);
        const textContent = await page.getTextContent();
        const strings = textContent.items.map(it => it.str);
        const joined = strings.join(' ')
          .replace(/\s+/g,' ') // normalize whitespace within line
          .trim();
        all.push(`--- Page ${p} / ${pdf.numPages} ---\n` + joined + "\n");
      }
      return all.join("\n");
    }

    async function buildDocxFromText(text){
      const { Document, Packer, Paragraph, HeadingLevel, PageBreak, TextRun } = window.docx;
      const paras = [];
      const chunks = text.split(/\n--- Page \d+ \/ \d+ ---\n/).filter(Boolean);
      // If the first split drops the first header, include text before first page marker
      if (chunks.length === 0){
        // Fallback: simple paragraph per line
        text.split(/\n+/).forEach(line => paras.push(new Paragraph(line)));
      } else {
        chunks.forEach((chunk, idx) => {
          if (idx>0) paras.push(new Paragraph({children:[new TextRun({break:1})]}));
          // Split chunk into sentences/lines roughly
          chunk.split(/(?<=\.)\s+|\n+/).forEach(line => {
            if(line.trim()) paras.push(new Paragraph(line.trim()));
          });
          if (idx < chunks.length - 1){
            paras.push(new Paragraph({ children: [ new PageBreak() ] }));
          }
        });
      }
      const doc = new Document({
        sections: [{
          properties: {},
          children: [
            new Paragraph({
              text: 'Converted from PDF — Storedropship',
              heading: HeadingLevel.HEADING_2
            }),
            ...paras
          ]
        }]
      });
      const blob = await Packer.toBlob(doc);
      return blob;
    }

    previewBtn.addEventListener('click', async () => {
      if (!currentPdfBytes){ alert('Please select a PDF first.'); return; }
      preview.textContent = 'Extracting text...';
      try{
        const text = await extractPdfText(currentPdfBytes);
        preview.textContent = text || '(No extractable text found)';
      }catch(err){
        console.error(err);
        preview.textContent = 'Failed to extract text from this PDF. It might be scanned or protected.';
      }
    });

    convertBtn.addEventListener('click', async () => {
      if (!currentPdfBytes){ alert('Please select a PDF first.'); return; }
      preview.textContent = 'Converting to DOCX...';
      try{
        const text = await extractPdfText(currentPdfBytes);
        const blob = await buildDocxFromText(text || '');
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url; a.download = 'converted.docx';
        document.body.appendChild(a); a.click(); a.remove();
        URL.revokeObjectURL(url);
        preview.textContent = 'Done! Your DOCX has been downloaded.';
      }catch(err){
        console.error(err);
        preview.textContent = 'Conversion failed. This PDF may require OCR or advanced layout handling.';
      }
    });

    clearBtn.addEventListener('click', () => {
      fileEl.value = '';
      currentPdfBytes = null;
      preview.textContent = '';
    });
  </script>
</body>
</html>
