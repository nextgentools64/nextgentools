<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Compress PDF Pro v6 | Storedropship Tools Hub</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<style>
*{box-sizing:border-box;font-family:'Inter',sans-serif}
body{
  margin:0;
  background:linear-gradient(135deg,#007acc,#00aaff);
  color:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  min-height:100vh;
  text-align:center;
}
.tool-container{
  background:rgba(255,255,255,0.12);
  padding:2rem;
  border-radius:20px;
  backdrop-filter:blur(12px);
  box-shadow:0 8px 25px rgba(0,0,0,0.15);
  width:90%;
  max-width:650px;
}
h1{font-size:1.6rem;margin-bottom:.5rem}
p{font-size:.95rem;margin-bottom:1.5rem}
input[type=file],select{
  margin:1rem 0;
  padding:10px;
  border-radius:10px;
  background:#fff;
  color:#333;
  border:none;
  width:100%;
}
button{
  background:#fff;
  color:#007acc;
  border:none;
  padding:10px 25px;
  border-radius:8px;
  font-weight:600;
  cursor:pointer;
  transition:.3s;
  margin-top:10px;
}
button:hover{background:#007acc;color:#fff}
progress{
  width:100%;height:15px;border-radius:10px;margin-top:10px;
  appearance:none;
}
progress::-webkit-progress-bar{background:rgba(255,255,255,0.2);border-radius:10px;}
progress::-webkit-progress-value{background:#fff;border-radius:10px;}
footer{margin-top:2rem;font-size:.85rem;color:rgba(255,255,255,.85)}
footer a{color:#fff;text-decoration:none;font-weight:600}
</style>
</head>
<body>

<div class="tool-container">
  <h1>Compress PDF Pro </h1>
  <p>Smart AI-based compression — keeps text clear & visuals sharp. Works 100% offline.</p>

  <input type="file" id="pdfFiles" accept="application/pdf" multiple>
  <label for="mode">Choose Compression Mode:</label>
  <select id="mode">
    <option value="light">Light (80% clarity, ~30% smaller)</option>
    <option value="balanced" selected>Balanced (90% clarity, ~50% smaller)</option>
    <option value="high">High (100% clarity, ~25% smaller)</option>
  </select>

  <button onclick="compressPDFs()">Compress PDFs</button>
  <progress id="progressBar" value="0" max="100" style="display:none;"></progress>
</div>

<footer>
  Made with ❤️ by <a href="https://storedropship.in/" target="_blank">Sheetal Sahu</a> |
  <a href="https://hostinger.in?REFERRALCODE=UOHSTOREDR07" target="_blank">Host on Hostinger</a>
</footer>

<script>
async function compressPDFs(){
  const files=document.getElementById('pdfFiles').files;
  const mode=document.getElementById('mode').value;
  const progress=document.getElementById('progressBar');
  if(!files.length){alert("Please select one or more PDFs.");return;}

  const zip=new JSZip();
  progress.style.display='block'; progress.value=0;

  // Smart mode adjustments
  let scaleFactor=1, imgQuality=0.9;
  if(mode==='light'){scaleFactor=0.7;imgQuality=0.75;}
  if(mode==='balanced'){scaleFactor=0.85;imgQuality=0.85;}
  if(mode==='high'){scaleFactor=1;imgQuality=0.95;}

  for(let i=0;i<files.length;i++){
    const file=files[i];
    const arrayBuffer=await file.arrayBuffer();
    const pdf=await pdfjsLib.getDocument({data:arrayBuffer}).promise;
    const pdfDoc=await PDFLib.PDFDocument.create();

    for(let p=1;p<=pdf.numPages;p++){
      const page=await pdf.getPage(p);
      const viewport=page.getViewport({scale:scaleFactor});
      const canvas=document.createElement('canvas');
      const ctx=canvas.getContext('2d');
      canvas.width=viewport.width;
      canvas.height=viewport.height;
      await page.render({canvasContext:ctx,viewport:viewport}).promise;

      const imgData=canvas.toDataURL('image/jpeg',imgQuality);
      const jpgImage=await pdfDoc.embedJpg(imgData);
      const newPage=pdfDoc.addPage([canvas.width,canvas.height]);
      newPage.drawImage(jpgImage,{x:0,y:0,width:canvas.width,height:canvas.height});
    }

    const compressedBytes=await pdfDoc.save();
    zip.file(file.name.replace('.pdf','_compressed.pdf'),compressedBytes);
    progress.value=((i+1)/files.length)*100;
  }

  const zipBlob=await zip.generateAsync({type:'blob'});
  const url=URL.createObjectURL(zipBlob);
  const a=document.createElement('a');
  a.href=url;
  a.download='storedropship-compressed-pdfs.zip';
  a.click();
  progress.style.display='none';
}
</script>

</body>
</html>
