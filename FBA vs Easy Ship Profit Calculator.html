<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Global Amazon Profit Calculator - FBA vs FBM | Storedropship Tools</title>
<meta name="description" content="Professional Amazon profit calculator comparing FBA vs FBM (Easy Ship) across global marketplaces. Calculate fees, profits, and ROI for your products.">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  :root {
    --primary: #0073b1;
    --primary-dark: #002244;
    --secondary: #00aaff;
    --success: #28a745;
    --danger: #dc3545;
    --warning: #ffc107;
    --light: #f8f9fa;
    --dark: #343a40;
    --gray: #6c757d;
    --light-gray: #e9ecef;
  }
  
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }
  
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f0f2f5;
    color: #333;
    line-height: 1.6;
  }
  
  header {
    background: var(--primary-dark);
    color: #fff;
    padding: 20px 0;
    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    position: sticky;
    top: 0;
    z-index: 100;
  }
  
  .header-content {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  header h1 {
    font-size: 26px;
    letter-spacing: 1px;
  }
  
  .logo {
    display: flex;
    align-items: center;
  }
  
  .logo i {
    font-size: 30px;
    margin-right: 10px;
    color: var(--secondary);
  }
  
  nav ul {
    display: flex;
    list-style: none;
  }
  
  nav ul li {
    margin-left: 20px;
  }
  
  nav ul li a {
    color: #fff;
    text-decoration: none;
    font-weight: 500;
    transition: color 0.3s;
  }
  
  nav ul li a:hover {
    color: var(--secondary);
  }
  
  .hero {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    padding: 40px 20px;
    text-align: center;
  }
  
  .hero h2 {
    font-size: 32px;
    margin-bottom: 15px;
  }
  
  .hero p {
    font-size: 18px;
    max-width: 800px;
    margin: 0 auto;
  }
  
  .controls {
    background: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    max-width: 1200px;
    margin: 20px auto;
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    justify-content: center;
  }
  
  .control-group {
    display: flex;
    flex-direction: column;
    min-width: 200px;
  }
  
  .control-group label {
    margin-bottom: 5px;
    font-weight: 600;
    color: var(--primary-dark);
  }
  
  select, input {
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 16px;
  }
  
  .container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    padding: 20px;
    max-width: 1200px;
    margin: auto;
  }
  
  .card {
    background: #fff;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    padding: 25px;
    margin: 15px;
    width: 100%;
    max-width: 500px;
    border-radius: 12px;
    transition: transform 0.3s, box-shadow 0.3s;
  }
  
  .card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0,0,0,0.15);
  }
  
  .card h3 {
    color: var(--primary);
    text-align: center;
    margin-bottom: 20px;
    font-size: 22px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .card h3 i {
    margin-right: 10px;
  }
  
  .form-group {
    margin-bottom: 15px;
  }
  
  label {
    display: block;
    margin: 8px 0 4px;
    font-weight: 600;
    color: var(--dark);
  }
  
  input {
    padding: 12px;
    margin-bottom: 5px;
    width: 100%;
    border: 1px solid #ccc;
    border-radius: 5px;
    transition: border 0.3s;
  }
  
  input:focus {
    border-color: var(--primary);
    outline: none;
    box-shadow: 0 0 0 3px rgba(0, 115, 177, 0.2);
  }
  
  .input-group {
    display: flex;
    align-items: center;
  }
  
  .input-group input {
    border-radius: 5px 0 0 5px;
  }
  
  .input-group .currency {
    background: var(--light-gray);
    padding: 12px 10px;
    border: 1px solid #ccc;
    border-left: none;
    border-radius: 0 5px 5px 0;
    font-weight: 600;
  }
  
  button {
    padding: 12px 20px;
    background: linear-gradient(to right, var(--primary), var(--secondary));
    color: #fff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 16px;
    font-weight: bold;
    transition: opacity 0.3s, transform 0.1s;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  button:hover {
    opacity: 0.95;
  }
  
  button:active {
    transform: scale(0.98);
  }
  
  .result {
    margin-top: 20px;
    background: var(--light);
    padding: 15px;
    border-radius: 8px;
    border-left: 4px solid var(--primary);
  }
  
  .result-item {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
  }
  
  .result-item:last-child {
    margin-bottom: 0;
    padding-top: 8px;
    border-top: 1px dashed #ccc;
    font-weight: bold;
    font-size: 18px;
  }
  
  .comparison {
    width: 100%;
    max-width: 1200px;
    margin: 30px auto;
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    overflow: hidden;
  }
  
  .comparison-header {
    background: var(--primary-dark);
    color: white;
    padding: 15px 20px;
    text-align: center;
  }
  
  .comparison-content {
    padding: 20px;
  }
  
  .chart-container {
    position: relative;
    height: 300px;
    margin: 20px 0;
  }
  
  .tabs {
    display: flex;
    border-bottom: 1px solid var(--light-gray);
    margin-bottom: 20px;
  }
  
  .tab {
    padding: 10px 20px;
    cursor: pointer;
    background: none;
    border: none;
    font-weight: 600;
    color: var(--gray);
    transition: color 0.3s, border-bottom 0.3s;
    border-bottom: 3px solid transparent;
  }
  
  .tab.active {
    color: var(--primary);
    border-bottom: 3px solid var(--primary);
  }
  
  .tab-content {
    display: none;
  }
  
  .tab-content.active {
    display: block;
  }
  
  .export-options {
    display: flex;
    gap: 10px;
    margin-top: 20px;
  }
  
  .export-btn {
    flex: 1;
    background: var(--success);
    color: white;
    padding: 10px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: 600;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .export-btn:hover {
    background: #218838;
  }
  
  .export-btn i {
    margin-right: 8px;
  }
  
  .notification {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: var(--success);
    color: white;
    padding: 15px 20px;
    border-radius: 5px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    display: flex;
    align-items: center;
    transform: translateY(100px);
    transition: transform 0.3s;
    z-index: 1000;
  }
  
  .notification.show {
    transform: translateY(0);
  }
  
  .notification i {
    margin-right: 10px;
  }
  
  footer {
    background: var(--primary-dark);
    color: #fff;
    text-align: center;
    padding: 30px 0;
    margin-top: 40px;
  }
  
  .footer-content {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
  }
  
  .footer-links {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    margin-bottom: 20px;
  }
  
  .footer-links a {
    color: #fff;
    text-decoration: none;
    margin: 0 15px;
    transition: color 0.3s;
  }
  
  .footer-links a:hover {
    color: var(--secondary);
  }
  
  .social-icons {
    margin-top: 15px;
  }
  
  .social-icons a {
    color: #fff;
    font-size: 20px;
    margin: 0 10px;
    transition: color 0.3s;
  }
  
  .social-icons a:hover {
    color: var(--secondary);
  }
  
  @media (max-width: 768px) {
    .header-content {
      flex-direction: column;
    }
    
    nav ul {
      margin-top: 15px;
    }
    
    .hero h2 {
      font-size: 24px;
    }
    
    .controls {
      flex-direction: column;
    }
    
    .control-group {
      width: 100%;
    }
  }
</style>
</head>
<body>
<header>
  <div class="header-content">
    <div class="logo">
      <i class="fas fa-calculator"></i>
      <h1>Storedropship Tools</h1>
    </div>
    <nav>
      <ul>
        <li><a href="#calculator">Calculator</a></li>
        <li><a href="#comparison">Comparison</a></li>
        <li><a href="#about">About</a></li>
        <li><a href="#contact">Contact</a></li>
      </ul>
    </nav>
  </div>
</header>

<div class="hero">
  <h2>Global Amazon Profit Calculator</h2>
  <p>Compare FBA vs FBM (Easy Ship) profits across all Amazon marketplaces. Make informed decisions for your e-commerce business.</p>
</div>

<div class="controls">
  <div class="control-group">
    <label for="marketplace">Amazon Marketplace:</label>
    <select id="marketplace">
      <option value="in">India (₹)</option>
      <option value="us">United States ($)</option>
      <option value="uk">United Kingdom (£)</option>
      <option value="ca">Canada (C$)</option>
      <option value="de">Germany (€)</option>
      <option value="fr">France (€)</option>
      <option value="jp">Japan (¥)</option>
      <option value="au">Australia (A$)</option>
    </select>
  </div>
  
  <div class="control-group">
    <label for="product-cost">Product Cost:</label>
    <div class="input-group">
      <input type="number" id="product-cost" value="500" min="0" step="0.01">
      <span class="currency" id="product-currency">₹</span>
    </div>
  </div>
  
  <div class="control-group">
    <label for="shipping-cost">Shipping Cost to Amazon:</label>
    <div class="input-group">
      <input type="number" id="shipping-cost" value="50" min="0" step="0.01">
      <span class="currency" id="shipping-currency">₹</span>
    </div>
  </div>
  
  <div class="control-group">
    <label for="prep-cost">Prep/Labeling Cost:</label>
    <div class="input-group">
      <input type="number" id="prep-cost" value="20" min="0" step="0.01">
      <span class="currency" id="prep-currency">₹</span>
    </div>
  </div>
</div>

<div class="container" id="calculator">
  <div class="card">
    <h3><i class="fas fa-shipping-fast"></i> FBM (Easy Ship)</h3>
    
    <div class="form-group">
      <label for="mrp1">Selling Price:</label>
      <div class="input-group">
        <input type="number" id="mrp1" value="1500" min="0" step="0.01">
        <span class="currency" id="mrp1-currency">₹</span>
      </div>
    </div>
    
    <div class="form-group">
      <label for="referral1">Referral Fee (%):</label>
      <input type="number" id="referral1" value="20" min="0" max="100" step="0.01">
    </div>
    
    <div class="form-group">
      <label for="easyCourier1">Courier Fee:</label>
      <div class="input-group">
        <input type="number" id="easyCourier1" value="100" min="0" step="0.01">
        <span class="currency" id="easyCourier1-currency">₹</span>
      </div>
    </div>
    
    <div class="form-group">
      <label for="closing1">Closing Fee:</label>
      <div class="input-group">
        <input type="number" id="closing1" value="20" min="0" step="0.01">
        <span class="currency" id="closing1-currency">₹</span>
      </div>
    </div>
    
    <div class="form-group">
      <label for="other-fees1">Other Fees:</label>
      <div class="input-group">
        <input type="number" id="other-fees1" value="0" min="0" step="0.01">
        <span class="currency" id="other-fees1-currency">₹</span>
      </div>
    </div>
    
    <button onclick="calculateFBM()"><i class="fas fa-calculator"></i> Calculate FBM Profit</button>
    
    <div class="result" id="output1">
      <div class="result-item">
        <span>Total Fees:</span>
        <span id="fbm-fees">₹0.00</span>
      </div>
      <div class="result-item">
        <span>Net Profit:</span>
        <span id="fbm-profit">₹0.00</span>
      </div>
      <div class="result-item">
        <span>Profit Margin:</span>
        <span id="fbm-margin">0%</span>
      </div>
      <div class="result-item">
        <span>ROI:</span>
        <span id="fbm-roi">0%</span>
      </div>
    </div>
  </div>
  
  <div class="card">
    <h3><i class="fas fa-warehouse"></i> FBA (Fulfillment by Amazon)</h3>
    
    <div class="form-group">
      <label for="mrp2">Selling Price:</label>
      <div class="input-group">
        <input type="number" id="mrp2" value="1500" min="0" step="0.01">
        <span class="currency" id="mrp2-currency">₹</span>
      </div>
    </div>
    
    <div class="form-group">
      <label for="referral2">Referral Fee (%):</label>
      <input type="number" id="referral2" value="20" min="0" max="100" step="0.01">
    </div>
    
    <div class="form-group">
      <label for="fbaFulfil2">Fulfillment Fee:</label>
      <div class="input-group">
        <input type="number" id="fbaFulfil2" value="120" min="0" step="0.01">
        <span class="currency" id="fbaFulfil2-currency">₹</span>
      </div>
    </div>
    
    <div class="form-group">
      <label for="fbaStorage2">Storage Fee/unit:</label>
      <div class="input-group">
        <input type="number" id="fbaStorage2" value="5" min="0" step="0.01">
        <span class="currency" id="fbaStorage2-currency">₹</span>
      </div>
    </div>
    
    <div class="form-group">
      <label for="closing2">Closing Fee:</label>
      <div class="input-group">
        <input type="number" id="closing2" value="20" min="0" step="0.01">
        <span class="currency" id="closing2-currency">₹</span>
      </div>
    </div>
    
    <div class="form-group">
      <label for="other-fees2">Other Fees:</label>
      <div class="input-group">
        <input type="number" id="other-fees2" value="0" min="0" step="0.01">
        <span class="currency" id="other-fees2-currency">₹</span>
      </div>
    </div>
    
    <button onclick="calculateFBA()"><i class="fas fa-calculator"></i> Calculate FBA Profit</button>
    
    <div class="result" id="output2">
      <div class="result-item">
        <span>Total Fees:</span>
        <span id="fba-fees">₹0.00</span>
      </div>
      <div class="result-item">
        <span>Net Profit:</span>
        <span id="fba-profit">₹0.00</span>
      </div>
      <div class="result-item">
        <span>Profit Margin:</span>
        <span id="fba-margin">0%</span>
      </div>
      <div class="result-item">
        <span>ROI:</span>
        <span id="fba-roi">0%</span>
      </div>
    </div>
  </div>
</div>

<div class="comparison" id="comparison">
  <div class="comparison-header">
    <h2>Profit Comparison & Analysis</h2>
  </div>
  <div class="comparison-content">
    <div class="tabs">
      <button class="tab active" onclick="openTab(event, 'chart-tab')">Visual Comparison</button>
      <button class="tab" onclick="openTab(event, 'break-even-tab')">Break-even Analysis</button>
      <button class="tab" onclick="openTab(event, 'sensitivity-tab')">Sensitivity Analysis</button>
    </div>
    
    <div id="chart-tab" class="tab-content active">
      <div class="chart-container">
        <canvas id="comparisonChart"></canvas>
      </div>
      
      <div class="export-options">
        <button class="export-btn" onclick="exportToPDF()"><i class="fas fa-file-pdf"></i> Export to PDF</button>
        <button class="export-btn" onclick="exportToExcel()"><i class="fas fa-file-excel"></i> Export to Excel</button>
        <button class="export-btn" onclick="saveCalculation()"><i class="fas fa-save"></i> Save Calculation</button>
      </div>
    </div>
    
    <div id="break-even-tab" class="tab-content">
      <h3>Break-even Analysis</h3>
      <p>This analysis shows how many units you need to sell to cover your initial investment.</p>
      <div class="chart-container">
        <canvas id="breakEvenChart"></canvas>
      </div>
    </div>
    
    <div id="sensitivity-tab" class="tab-content">
      <h3>Sensitivity Analysis</h3>
      <p>See how changes in key variables affect your profitability.</p>
      <div class="form-group">
        <label for="sensitivity-var">Variable to Analyze:</label>
        <select id="sensitivity-var">
          <option value="price">Selling Price</option>
          <option value="cost">Product Cost</option>
          <option value="fees">Amazon Fees</option>
        </select>
      </div>
      <div class="chart-container">
        <canvas id="sensitivityChart"></canvas>
      </div>
    </div>
  </div>
</div>

<footer>
  <div class="footer-content">
    <div class="footer-links">
      <a href="#privacy">Privacy Policy</a>
      <a href="#terms">Terms of Service</a>
      <a href="#about">About Us</a>
      <a href="#contact">Contact</a>
      <a href="#faq">FAQ</a>
    </div>
    <p>© 2025 Storedropship.in | Professional E-commerce Tools</p>
    <div class="social-icons">
      <a href="#"><i class="fab fa-facebook"></i></a>
      <a href="#"><i class="fab fa-twitter"></i></a>
      <a href="#"><i class="fab fa-linkedin"></i></a>
      <a href="#"><i class="fab fa-instagram"></i></a>
    </div>
  </div>
</footer>

<div class="notification" id="notification">
  <i class="fas fa-check-circle"></i>
  <span id="notification-text">Calculation saved successfully!</span>
</div>

<script>
// Currency symbols for different marketplaces
const currencySymbols = {
  'in': '₹',
  'us': '$',
  'uk': '£',
  'ca': 'C$',
  'de': '€',
  'fr': '€',
  'jp': '¥',
  'au': 'A$'
};

// Marketplace fee structures (simplified for demo)
const marketplaceFees = {
  'in': {
    name: 'India',
    closingFee: 20,
    currency: '₹'
  },
  'us': {
    name: 'United States',
    closingFee: 1.80,
    currency: '$'
  },
  'uk': {
    name: 'United Kingdom',
    closingFee: 1.50,
    currency: '£'
  },
  'ca': {
    name: 'Canada',
    closingFee: 2.40,
    currency: 'C$'
  },
  'de': {
    name: 'Germany',
    closingFee: 1.60,
    currency: '€'
  },
  'fr': {
    name: 'France',
    closingFee: 1.60,
    currency: '€'
  },
  'jp': {
    name: 'Japan',
    closingFee: 200,
    currency: '¥'
  },
  'au': {
    name: 'Australia',
    closingFee: 2.50,
    currency: 'A$'
  }
};

// Initialize variables to store calculation results
let fbmResult = {};
let fbaResult = {};
let comparisonChart = null;
let breakEvenChart = null;
let sensitivityChart = null;

// Update currency symbols when marketplace changes
document.getElementById('marketplace').addEventListener('change', function() {
  const marketplace = this.value;
  const currency = currencySymbols[marketplace];
  
  // Update all currency symbols
  document.querySelectorAll('.currency').forEach(el => {
    el.textContent = currency;
  });
  
  // Update closing fees based on marketplace
  document.getElementById('closing1').value = marketplaceFees[marketplace].closingFee;
  document.getElementById('closing2').value = marketplaceFees[marketplace].closingFee;
});

function calculateFBM() {
  const marketplace = document.getElementById('marketplace').value;
  const currency = currencySymbols[marketplace];
  
  const mrp = parseFloat(document.getElementById('mrp1').value);
  const referral = parseFloat(document.getElementById('referral1').value);
  const easyCourier = parseFloat(document.getElementById('easyCourier1').value);
  const closing = parseFloat(document.getElementById('closing1').value);
  const otherFees = parseFloat(document.getElementById('other-fees1').value);
  const productCost = parseFloat(document.getElementById('product-cost').value);
  const shippingCost = parseFloat(document.getElementById('shipping-cost').value);
  const prepCost = parseFloat(document.getElementById('prep-cost').value);
  
  if (isNaN(mrp) || isNaN(referral) || isNaN(easyCourier) || isNaN(closing) || isNaN(otherFees) || 
      isNaN(productCost) || isNaN(shippingCost) || isNaN(prepCost)) {
    showNotification('Please enter valid inputs.', 'error');
    return;
  }
  
  const referralFee = (mrp * referral) / 100;
  const totalFees = referralFee + easyCourier + closing + otherFees;
  const totalCost = productCost + shippingCost + prepCost;
  const netProfit = mrp - totalFees - totalCost;
  const profitMargin = mrp > 0 ? (netProfit / mrp) * 100 : 0;
  const roi = totalCost > 0 ? (netProfit / totalCost) * 100 : 0;
  
  // Store results
  fbmResult = {
    mrp: mrp,
    totalFees: totalFees,
    totalCost: totalCost,
    netProfit: netProfit,
    profitMargin: profitMargin,
    roi: roi,
    currency: currency
  };
  
  // Update UI
  document.getElementById('fbm-fees').textContent = `${currency}${totalFees.toFixed(2)}`;
  document.getElementById('fbm-profit').textContent = `${currency}${netProfit.toFixed(2)}`;
  document.getElementById('fbm-margin').textContent = `${profitMargin.toFixed(2)}%`;
  document.getElementById('fbm-roi').textContent = `${roi.toFixed(2)}%`;
  
  // Update comparison chart if FBA has been calculated
  if (Object.keys(fbaResult).length > 0) {
    updateComparisonChart();
  }
  
  showNotification('FBM calculation completed!');
}

function calculateFBA() {
  const marketplace = document.getElementById('marketplace').value;
  const currency = currencySymbols[marketplace];
  
  const mrp = parseFloat(document.getElementById('mrp2').value);
  const referral = parseFloat(document.getElementById('referral2').value);
  const fbaFulfil = parseFloat(document.getElementById('fbaFulfil2').value);
  const fbaStorage = parseFloat(document.getElementById('fbaStorage2').value);
  const closing = parseFloat(document.getElementById('closing2').value);
  const otherFees = parseFloat(document.getElementById('other-fees2').value);
  const productCost = parseFloat(document.getElementById('product-cost').value);
  const shippingCost = parseFloat(document.getElementById('shipping-cost').value);
  const prepCost = parseFloat(document.getElementById('prep-cost').value);
  
  if (isNaN(mrp) || isNaN(referral) || isNaN(fbaFulfil) || isNaN(fbaStorage) || isNaN(closing) || isNaN(otherFees) ||
      isNaN(productCost) || isNaN(shippingCost) || isNaN(prepCost)) {
    showNotification('Please enter valid inputs.', 'error');
    return;
  }
  
  const referralFee = (mrp * referral) / 100;
  const totalFees = referralFee + fbaFulfil + fbaStorage + closing + otherFees;
  const totalCost = productCost + shippingCost + prepCost;
  const netProfit = mrp - totalFees - totalCost;
  const profitMargin = mrp > 0 ? (netProfit / mrp) * 100 : 0;
  const roi = totalCost > 0 ? (netProfit / totalCost) * 100 : 0;
  
  // Store results
  fbaResult = {
    mrp: mrp,
    totalFees: totalFees,
    totalCost: totalCost,
    netProfit: netProfit,
    profitMargin: profitMargin,
    roi: roi,
    currency: currency
  };
  
  // Update UI
  document.getElementById('fba-fees').textContent = `${currency}${totalFees.toFixed(2)}`;
  document.getElementById('fba-profit').textContent = `${currency}${netProfit.toFixed(2)}`;
  document.getElementById('fba-margin').textContent = `${profitMargin.toFixed(2)}%`;
  document.getElementById('fba-roi').textContent = `${roi.toFixed(2)}%`;
  
  // Update comparison chart if FBM has been calculated
  if (Object.keys(fbmResult).length > 0) {
    updateComparisonChart();
  }
  
  showNotification('FBA calculation completed!');
}

function updateComparisonChart() {
  const ctx = document.getElementById('comparisonChart').getContext('2d');
  
  // Destroy previous chart if it exists
  if (comparisonChart) {
    comparisonChart.destroy();
  }
  
  comparisonChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: ['Net Profit', 'Total Fees', 'Total Cost'],
      datasets: [
        {
          label: 'FBM (Easy Ship)',
          data: [fbmResult.netProfit, fbmResult.totalFees, fbmResult.totalCost],
          backgroundColor: 'rgba(54, 162, 235, 0.7)',
          borderColor: 'rgba(54, 162, 235, 1)',
          borderWidth: 1
        },
        {
          label: 'FBA',
          data: [fbaResult.netProfit, fbaResult.totalFees, fbaResult.totalCost],
          backgroundColor: 'rgba(255, 99, 132, 0.7)',
          borderColor: 'rgba(255, 99, 132, 1)',
          borderWidth: 1
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        y: {
          beginAtZero: true,
          title: {
            display: true,
            text: `Amount (${fbmResult.currency})`
          }
        }
      },
      plugins: {
        title: {
          display: true,
          text: 'FBM vs FBA Profit Comparison'
        },
        tooltip: {
          callbacks: {
            label: function(context) {
              return `${context.dataset.label}: ${fbmResult.currency}${context.raw.toFixed(2)}`;
            }
          }
        }
      }
    }
  });
  
  // Update break-even chart
  updateBreakEvenChart();
}

function updateBreakEvenChart() {
  const ctx = document.getElementById('breakEvenChart').getContext('2d');
  
  // Destroy previous chart if it exists
  if (breakEvenChart) {
    breakEvenChart.destroy();
  }
  
  // Calculate break-even points
  const fbmBreakEven = fbmResult.totalCost > 0 && fbmResult.netProfit > 0 ? 
    Math.ceil(fbmResult.totalCost / fbmResult.netProfit) : 0;
  
  const fbaBreakEven = fbaResult.totalCost > 0 && fbaResult.netProfit > 0 ? 
    Math.ceil(fbaResult.totalCost / fbaResult.netProfit) : 0;
  
  breakEvenChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: ['Units to Break Even'],
      datasets: [
        {
          label: 'FBM (Easy Ship)',
          data: [fbmBreakEven],
          backgroundColor: 'rgba(54, 162, 235, 0.7)',
          borderColor: 'rgba(54, 162, 235, 1)',
          borderWidth: 1
        },
        {
          label: 'FBA',
          data: [fbaBreakEven],
          backgroundColor: 'rgba(255, 99, 132, 0.7)',
          borderColor: 'rgba(255, 99, 132, 1)',
          borderWidth: 1
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        y: {
          beginAtZero: true,
          title: {
            display: true,
            text: 'Number of Units'
          }
        }
      },
      plugins: {
        title: {
          display: true,
          text: 'Break-even Analysis'
        },
        tooltip: {
          callbacks: {
            label: function(context) {
              return `${context.dataset.label}: ${context.raw} units`;
            }
          }
        }
      }
    }
  });
}

function updateSensitivityChart() {
  const ctx = document.getElementById('sensitivityChart').getContext('2d');
  const variable = document.getElementById('sensitivity-var').value;
  
  // Destroy previous chart if it exists
  if (sensitivityChart) {
    sensitivityChart.destroy();
  }
  
  let labels = [];
  let fbmData = [];
  let fbaData = [];
  
  // Generate data based on selected variable
  if (variable === 'price') {
    labels = ['-20%', '-10%', '0%', '+10%', '+20%'];
    for (let i = 0; i < 5; i++) {
      const priceChange = (i - 2) * 0.1; // -0.2, -0.1, 0, 0.1, 0.2
      
      // Calculate FBM profit with price change
      const fbmMrp = fbmResult.mrp * (1 + priceChange);
      const fbmReferralFee = (fbmMrp * parseFloat(document.getElementById('referral1').value)) / 100;
      const fbmTotalFees = fbmReferralFee + parseFloat(document.getElementById('easyCourier1').value) + 
                          parseFloat(document.getElementById('closing1').value) + parseFloat(document.getElementById('other-fees1').value);
      const fbmProfit = fbmMrp - fbmTotalFees - fbmResult.totalCost;
      fbmData.push(fbmProfit);
      
      // Calculate FBA profit with price change
      const fbaMrp = fbaResult.mrp * (1 + priceChange);
      const fbaReferralFee = (fbaMrp * parseFloat(document.getElementById('referral2').value)) / 100;
      const fbaTotalFees = fbaReferralFee + parseFloat(document.getElementById('fbaFulfil2').value) + 
                          parseFloat(document.getElementById('fbaStorage2').value) + parseFloat(document.getElementById('closing2').value) + 
                          parseFloat(document.getElementById('other-fees2').value);
      const fbaProfit = fbaMrp - fbaTotalFees - fbaResult.totalCost;
      fbaData.push(fbaProfit);
    }
  } else if (variable === 'cost') {
    labels = ['-20%', '-10%', '0%', '+10%', '+20%'];
    for (let i = 0; i < 5; i++) {
      const costChange = (i - 2) * 0.1; // -0.2, -0.1, 0, 0.1, 0.2
      
      // Calculate FBM profit with cost change
      const fbmTotalCost = fbmResult.totalCost * (1 + costChange);
      const fbmProfit = fbmResult.mrp - fbmResult.totalFees - fbmTotalCost;
      fbmData.push(fbmProfit);
      
      // Calculate FBA profit with cost change
      const fbaTotalCost = fbaResult.totalCost * (1 + costChange);
      const fbaProfit = fbaResult.mrp - fbaResult.totalFees - fbaTotalCost;
      fbaData.push(fbaProfit);
    }
  } else if (variable === 'fees') {
    labels = ['-20%', '-10%', '0%', '+10%', '+20%'];
    for (let i = 0; i < 5; i++) {
      const feeChange = (i - 2) * 0.1; // -0.2, -0.1, 0, 0.1, 0.2
      
      // Calculate FBM profit with fee change
      const fbmTotalFees = fbmResult.totalFees * (1 + feeChange);
      const fbmProfit = fbmResult.mrp - fbmTotalFees - fbmResult.totalCost;
      fbmData.push(fbmProfit);
      
      // Calculate FBA profit with fee change
      const fbaTotalFees = fbaResult.totalFees * (1 + feeChange);
      const fbaProfit = fbaResult.mrp - fbaTotalFees - fbaResult.totalCost;
      fbaData.push(fbaProfit);
    }
  }
  
  sensitivityChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: labels,
      datasets: [
        {
          label: 'FBM (Easy Ship)',
          data: fbmData,
          backgroundColor: 'rgba(54, 162, 235, 0.1)',
          borderColor: 'rgba(54, 162, 235, 1)',
          borderWidth: 2,
          fill: true,
          tension: 0.4
        },
        {
          label: 'FBA',
          data: fbaData,
          backgroundColor: 'rgba(255, 99, 132, 0.1)',
          borderColor: 'rgba(255, 99, 132, 1)',
          borderWidth: 2,
          fill: true,
          tension: 0.4
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        y: {
          title: {
            display: true,
            text: `Profit (${fbmResult.currency})`
          }
        }
      },
      plugins: {
        title: {
          display: true,
          text: `Sensitivity Analysis: ${variable.charAt(0).toUpperCase() + variable.slice(1)}`
        },
        tooltip: {
          callbacks: {
            label: function(context) {
              return `${context.dataset.label}: ${fbmResult.currency}${context.raw.toFixed(2)}`;
            }
          }
        }
      }
    }
  });
}

function openTab(evt, tabName) {
  // Hide all tab content
  const tabContents = document.getElementsByClassName('tab-content');
  for (let i = 0; i < tabContents.length; i++) {
    tabContents[i].classList.remove('active');
  }
  
  // Remove active class from all tab buttons
  const tabs = document.getElementsByClassName('tab');
  for (let i = 0; i < tabs.length; i++) {
    tabs[i].classList.remove('active');
  }
  
  // Show the specific tab content
  document.getElementById(tabName).classList.add('active');
  
  // Add active class to the button that opened the tab
  evt.currentTarget.classList.add('active');
  
  // Update sensitivity chart if sensitivity tab is opened
  if (tabName === 'sensitivity-tab') {
    updateSensitivityChart();
  }
}

function exportToPDF() {
  // In a real implementation, this would use a PDF library like jsPDF
  showNotification('PDF export feature would be implemented here.');
}

function exportToExcel() {
  // In a real implementation, this would use a library like SheetJS
  showNotification('Excel export feature would be implemented here.');
}

function saveCalculation() {
  // In a real implementation, this would save to localStorage or a database
  const calculation = {
    date: new Date().toISOString(),
    marketplace: document.getElementById('marketplace').value,
    fbm: fbmResult,
    fba: fbaResult
  };
  
  // Save to localStorage
  let savedCalculations = JSON.parse(localStorage.getItem('storedropship_calculations') || '[]');
  savedCalculations.push(calculation);
  localStorage.setItem('storedropship_calculations', JSON.stringify(savedCalculations));
  
  showNotification('Calculation saved successfully!');
}

function showNotification(message, type = 'success') {
  const notification = document.getElementById('notification');
  const notificationText = document.getElementById('notification-text');
  
  notificationText.textContent = message;
  
  // Set notification color based on type
  if (type === 'error') {
    notification.style.background = 'var(--danger)';
  } else {
    notification.style.background = 'var(--success)';
  }
  
  // Show notification
  notification.classList.add('show');
  
  // Hide notification after 3 seconds
  setTimeout(() => {
    notification.classList.remove('show');
  }, 3000);
}

// Initialize the page
document.addEventListener('DOMContentLoaded', function() {
  // Set initial currency based on marketplace
  const marketplace = document.getElementById('marketplace').value;
  const currency = currencySymbols[marketplace];
  
  // Update all currency symbols
  document.querySelectorAll('.currency').forEach(el => {
    el.textContent = currency;
  });
});
</script>
</body>
</html>