<!doctype html>
<html lang="hi">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Multi-Subject Exam Generator — Sections & Marks</title>
  <style>
    :root{--bg:#f5f7fb;--card:#fff;--accent:#0b6bf0;--muted:#6b7280}
    body{font-family:Inter,system-ui,Arial,sans-serif;background:var(--bg);color:#071133;padding:18px}
    .container{max-width:1100px;margin:0 auto;background:var(--card);padding:18px;border-radius:10px;box-shadow:0 8px 24px rgba(2,6,23,0.06)}
    h1{margin:0 0 12px;font-size:20px}
    label{display:block;margin:8px 0 4px;font-weight:700}
    input,select,textarea,button{font-family:inherit}
    input,select,textarea{width:100%;padding:8px;border:1px solid #e6eef8;border-radius:8px}
    .row{display:flex;gap:12px}
    .col{flex:1}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    button{padding:10px 14px;border:none;border-radius:8px;cursor:pointer;background:var(--accent);color:#fff;font-weight:700}
    .small{padding:8px 12px;background:#111827;color:#fff;border-radius:8px}
    .paper{margin-top:18px;padding:18px;border:1px dashed #d1e9ff;background:#fbfdff;border-radius:8px}
    .question{margin:8px 0}
    .meta{font-size:13px;color:#374151}
    .hint{font-size:13px;color:var(--muted)}
    .switch{display:flex;align-items:center;gap:8px}
    @media (max-width:820px){.row{flex-direction:column}}
    @media print{.no-print{display:none} .container{box-shadow:none}}
    ol{padding-left:18px}
  </style>
</head>
<body>
  <div class="container">
    <h1>Multi-Subject Exam Generator — Sections & Marks</h1>

    <div class="no-print">
      <div class="row">
        <div class="col">
          <label>School / संस्थान</label>
          <input id="school" value="New Hopes Public Higher Secondary School Kakrala"/>
        </div>
        <div class="col">
          <label>Exam Title</label>
          <input id="title" value="Half Yearly Examination 2025"/>
        </div>
        <div class="col">
          <label>Class & Subject</label>
          <select id="subject">
            <option value="SST">SST (Social Science)</option>
            <option value="Math">Math (गणित)</option>
            <option value="Science">Science (विज्ञान)</option>
            <option value="English">English</option>
            <option value="Hindi">Hindi (हिंदी)</option>
            <option value="Other">Other / Generic</option>
          </select>
        </div>
      </div>

      <div class="row" style="margin-top:10px">
        <div class="col">
          <label>Language / भाषा</label>
          <select id="lang"><option value="bilingual">Bilingual</option><option value="hindi">Hindi</option><option value="english">English</option></select>
        </div>
        <div class="col">
          <label>Time</label>
          <input id="time" value="3:00"/>
        </div>
        <div class="col">
          <label>Total Marks</label>
          <input id="marks" value="70"/>
        </div>
      </div>

      <div style="margin-top:10px" class="row">
        <div class="col">
          <label>Use sections? (यदि टिक है → Section A/B/C दिखेंगे; वरना flat list)</label>
          <div class="switch"><input type="checkbox" id="useSections" checked/> <label for="useSections">Use sections (Section-wise layout)</label></div>
        </div>
        <div class="col">
          <label>Marks per question (MCQ,Short,Long) — comma separated</label>
          <input id="marksPer" value="1,3,8" placeholder="e.g. 1,3,8"/>
        </div>
        <div class="col">
          <label>Counts (MCQ,Short,Long) — comma separated</label>
          <input id="counts" value="20,5,4" placeholder="e.g. 20,5,4"/>
        </div>
      </div>

      <label>Custom topics / paste questions (one per line). For Math leave empty for auto-generated numeric problems.</label>
      <textarea id="topics" placeholder="E.g. Fractions, Linear equations, World War I, Photosynthesis"></textarea>

      <div class="controls">
        <button id="generate">Generate Paper</button>
        <button id="generateKey" class="small">Generate + Show Answer Key</button>
        <button id="downloadDoc" class="small">Download as Word (.doc)</button>
        <button id="downloadHtml" class="small">Download HTML</button>
        <button id="print" class="small">Print / Save as PDF</button>
        <button id="clear" class="small">Clear Output</button>
      </div>

      <div style="margin-top:10px" class="hint">Tip: यदि किसी subject के लिए sections नहीं चाहिए (उदा. small quiz), तो 'Use sections' को अनचेक कर दें — तब flat numbered list बनेगा, हर प्रश्न के पास (marks) दिखेगा।</div>
    </div>

    <div id="output" class="paper"></div>
  </div>

<script>
/* ===== Utilities ===== */
function randInt(a,b){return Math.floor(Math.random()*(b-a+1))+a}
function pick(arr){return arr[randInt(0,arr.length-1)]}
function escapeHtml(s){return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')}

/* ===== Templates ===== */
const SST_MCQS = [
"Who discovered America?||a) Alfred Crosby||b) John Winthrop||c) M.W. Ridley||d) Christopher Columbus",
"Name the most important route in the ancient world trade.||a) Caravan route||b) Silk route||c) Indo-Japanese route||d) Cape route",
"Where was the Bretton Woods institution situated?||a) Africa||b) Europe||c) America||d) None of these",
"When did the First World War start?||a) 1914||b) 1939||c) 1919||d) 1942",
"When was the IMF established?||a) 1940||b) 1942||c) 1945||d) 1947",
"What year did the Great Depression begin?||a) 1919 AD||b) 1924 AD||c) 1929 AD||d) 1934 AD",
"The country related to 'Corn Law' is||a) Germany||b) U.S.A||c) France||d) Britain",
"Which river is associated with Hirakud Dam?||a) Narmada||b) Tapi||c) Mahanadi||d) Ganga",
"With which dam is the Narmada Bachao Andolan associated?||a) Nagarjuna Sagar||b) Sardar Sarovar||c) Hirakud||d) Gandhi Sagar",
"Salal Dam is constructed on which river?||a) Mahanadi||b) Chenab||c) Satluj||d) Krishna",
"The main crop grown on black soil is||a) Wheat||b) Cotton||c) Maize||d) Bajra",
"Which one of the following is a fibre crop?||a) Tea||b) Sugarcane||c) Jute||d) Rubber",
"Which of the following is not a commercial crop?||a) Millet||b) Tea||c) Rubber||d) Coffee",
"'Bhoodan' movement was initiated by||a) Mahatma Gandhi||b) Jawaharlal Nehru||c) Vinoba Bhave||d) None of these",
"Which one of the following is not a federal state?||a) Uttar Pradesh||b) Madhya Pradesh||c) Delhi||d) Bihar",
"How many federal states are there in India?||a) 27||b) 28||c) 29||d) 30",
"At present how many union territories are there in the Indian Union?||a) 09||b) 07||c) 10||d) 08",
"What is the voting age in India?||a) 21 years||b) 20 years||c) 25 years||d) 18 years",
"When did the written Constitution come into force in India?||a) 15 August||b) 14 August||c) 10 December||d) 26 January",
"According to the Constitution the official language of India is||a) Hindi||b) Urdu||c) Sanskrit||d) English"
];

const SST_DESC = [
"Any two differences between the local government before and after Constitution Amendment in 1992.",
"Name one important beverage crop and specify the geographical conditions required for its growth.",
"Give two examples of different types of global exchanges which took place before the seventeenth century (one from Asia and one from the Americas).",
"Give two historical examples to show the impact of technology on food availability.",
"What is meant by the Bretton Woods Agreement?"
];

const SST_LONG = [
"Explain the causes of the Great Depression.",
"Compare the advantages and disadvantages of multipurpose river projects.",
"What is water scarcity and what are its main causes?",
"Distinguish between open unemployment and disguised unemployment."
];

/* Math generator */
function generateMathMCQItem(){
  const types = ['add','sub','mul','div','alg'];
  const t = pick(types);
  if(t==='add'){ const a=randInt(10,99), b=randInt(5,99); const c=a+b; return {q:`Compute ${a} + ${b}`, ans:c}; }
  if(t==='sub'){ const a=randInt(50,299), b=randInt(1,49); const c=a-b; return {q:`Compute ${a} − ${b}`, ans:c}; }
  if(t==='mul'){ const a=randInt(2,15), b=randInt(2,12); const c=a*b; return {q:`Compute ${a} × ${b}`, ans:c}; }
  if(t==='div'){ const b=randInt(2,12), ans=randInt(2,12); const a=b*ans; return {q:`Compute ${a} ÷ ${b}`, ans}; }
  if(t==='alg'){ const x=randInt(2,12), a=randInt(1,5), b=randInt(1,20); const expr=`${a}x + ${b} = ${a*x + b}`; return {q:`Solve for x: ${expr}`, ans:x}; }
}

/* Simple templates for other subjects (kept short) */
const ENG_COMPREHENSION = `Read the passage and answer the questions that follow:\nIndia is a land of diverse cultures and languages. The history of trade, colonial influence, and social reforms shaped the modern state.`;
const ENG_GRAMMAR = ["She ____ to school every day. (go/goes)","Fill: He is good ___ mathematics.","Identify error: 'He don't like apples.'"];
const ENG_WRITING = ["Write a letter to the principal requesting a science exhibition.","Write a paragraph on discipline."];

const HINDI_COMPREHENSION = "लघु गद्यांश: भारत विविधताओं का देश।\n";
const HINDI_GRAMMAR = ["राम ____ बाज़ार गया। (को/ने)","वह ____ विद्यार्थी है।"];
const HINDI_WRITING = ["विद्यालय में साफ़-सफाई पर निबंध लिखिए।","एक आवेदन पत्र लिखिए।"];

const SCI_MCQS = ["Photosynthesis occurs in which organelle?||a) Mitochondria||b) Chloroplast||c) Nucleus||d) Ribosome","Which gas is produced during photosynthesis?||a) CO2||b) Oxygen||c) Nitrogen||d) Hydrogen"];
const SCI_SHORT = ["Define osmosis.","State Newton's second law."];
const SCI_LONG = ["Explain photosynthesis with diagram.","Describe the structure of the human heart."];

/* ===== Build paper ===== */
function buildPaper(opts){
  const {school,title,subject,lang,time,marks,useSections,marksPer,counts,topics} = opts;
  let html = `<div class="meta"><strong>${escapeHtml(school)}</strong><br/><strong>${escapeHtml(title)}</strong><br/>${escapeHtml(subject)} &nbsp;&nbsp; Time: ${escapeHtml(time)} &nbsp;&nbsp; Marks: ${escapeHtml(marks)}</div><hr/>`;

  const [mcqMarks, shortMarks, longMarks] = marksPer;
  const [mcqCount, shortCount, longCount] = counts;

  let qNo = 1;
  const answers = [];

  function addMCQ(qtext, options){
    const markText = `(${mcqMarks} mark${mcqMarks>1?'s':''})`;
    if(useSections){
      html += `<li class="question"><strong>${qNo}.</strong> ${escapeHtml(qtext)} <em>${markText}</em><br/>`;
      if(options && options.length){
        options.forEach(opt => { html += `&nbsp;&nbsp;${escapeHtml(opt)} &nbsp;[ &nbsp; ]<br/>`; });
      }
      html += `</li>`;
    } else {
      html += `<div class="question"><strong>${qNo}.</strong> ${escapeHtml(qtext)} <em>${markText}</em><br/>`;
      if(options && options.length){
        options.forEach(opt => { html += `&nbsp;&nbsp;${escapeHtml(opt)} &nbsp;[ &nbsp; ]<br/>`; });
      }
      html += `</div>`;
    }
    qNo++;
  }

  function addShort(qtext){
    const markText = `(${shortMarks} marks)`;
    if(useSections){
      html += `<li class="question"><strong>${qNo}.</strong> ${escapeHtml(qtext)} <em>${markText}</em></li>`;
    } else {
      html += `<div class="question"><strong>${qNo}.</strong> ${escapeHtml(qtext)} <em>${markText}</em></div>`;
    }
    qNo++;
  }

  function addLong(qtext){
    const markText = `(${longMarks} marks)`;
    if(useSections){
      html += `<li class="question"><strong>${qNo}.</strong> ${escapeHtml(qtext)} <em>${markText}</em></li>`;
    } else {
      html += `<div class="question"><strong>${qNo}.</strong> ${escapeHtml(qtext)} <em>${markText}</em></div>`;
    }
    qNo++;
  }

  /* Build per-subject */
  if(useSections){
    // We'll create section headers and use ordered lists so numbering looks contiguous visually.
    if(subject==='SST'){
      html += `<h3>Section A — Multiple Choice Questions (${mcqCount} x ${mcqMarks})</h3><ol>`;
      for(let i=0;i<mcqCount;i++){
        const parts = SST_MCQS[i % SST_MCQS.length].split('||');
        addMCQ(parts[0], parts.slice(1));
      }
      html += `</ol>`;

      html += `<h3>Section B — Short Answer Questions (${shortCount} x ${shortMarks})</h3><ol start="${qNo}">`;
      for(let i=0;i<shortCount;i++){ addShort(SST_DESC[i % SST_DESC.length]); }
      html += `</ol>`;
      // update qNo automatically by counting items added above
      qNo = qNo; // no-op to show clarity

      html += `<h3>Section C — Long Answer Questions (${longCount} x ${longMarks})</h3><ol start="${qNo}">`;
      for(let i=0;i<longCount;i++){ addLong(SST_LONG[i % SST_LONG.length]); }
      html += `</ol>`;

      html += `<h3>Section D — Map / Activity</h3><ol start="${qNo}">`;
      addLong("Identify and shade three federal countries (other than India): Brazil, South Africa, Russia."); // counts as long-type question
      html += `</ol>`;
    }

    else if(subject==='Math'){
      html += `<h3>Section A — MCQs (${mcqCount} x ${mcqMarks})</h3><ol>`;
      for(let i=0;i<mcqCount;i++){ const it = generateMathMCQItem(); addMCQ(it.q); answers.push(`${qNo-1}: ${it.ans}`); }
      html += `</ol>`;
      html += `<h3>Section B — Short Answer (${shortCount} x ${shortMarks})</h3><ol start="${qNo}">`;
      for(let i=0;i<shortCount;i++){ const a=randInt(2,30), b=randInt(2,12); addShort(`Solve: ${a}x = ${a*b}`); answers.push(`S${i+1}: x=${b}`); }
      html +=
